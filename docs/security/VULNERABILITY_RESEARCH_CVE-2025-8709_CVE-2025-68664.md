# Vulnerability Research: CVE-2025-8709 & CVE-2025-68664

**Date:** 2025-01-XX  
**Status:** Research Complete - Awaiting Approval

## Executive Summary

Research conducted on two vulnerabilities reported in NSpect scan:
1. **CVE-2025-8709** (Critical) - SQL Injection in LangGraph SQLite checkpoint
2. **CVE-2025-68664** (High) - Serialization Injection in LangChain

## Vulnerability 1: CVE-2025-8709 (Critical)

### Details
- **CVE ID:** CVE-2025-8709
- **BDSA ID:** BDSA-2025-14538
- **Severity:** Critical
- **Component:** `langgraph-checkpoint-sqlite`
- **Vulnerable Version:** 2.0.10
- **Patched Version:** **2.0.11** (minimum)
- **Latest Available:** 3.0.1

### Description
SQL injection vulnerability in `langgraph-checkpoint-sqlite` package due to improper handling of filter operators in `json_extract` functionality. Attackers can inject arbitrary SQL commands through filter operations.

### Current Status
- **requirements.lock:** `langgraph-checkpoint==2.1.2` (vulnerable if includes SQLite component)
- **Installed in environment:** `langgraph-checkpoint==3.0.1` ‚úÖ (likely safe, version > 2.0.11)
- **Latest available:** `langgraph-checkpoint==3.0.1`

### Mitigation
‚úÖ **Already mitigated** - Installed version (3.0.1) is newer than patched version (2.0.11)

**Action Required:**
- Update `requirements.lock` to reflect installed version
- Verify that `langgraph-checkpoint` 3.0.1 includes the SQLite component fix
- Document that we use in-memory state (no SQLite checkpoint) as additional defense

---

## Vulnerability 2: CVE-2025-68664 (High)

### Details
- **CVE ID:** CVE-2025-68664
- **BDSA ID:** BDSA-2025-77504
- **Severity:** High
- **Component:** `langchain` / `langchain-core`
- **Vulnerable Version:** 0.3.80 (reported in CSV)
- **Patched Version:** **Unknown** (research incomplete)
- **Latest Available:** 1.2.6

### Description
Serialization injection vulnerability in LangChain's `dumps()` and `dumpd()` functions. Improper handling of dictionaries with `'lc'` keys allows malicious objects to be treated as LangChain objects during deserialization, potentially leading to:
- Unauthorized access to environment variable secrets
- Arbitrary class instantiation
- Side effects (network calls, file operations)

### Current Status
- **requirements.txt:** `langchain-core>=1.2.6` ‚úÖ (patched version)
- **requirements.lock:** `langchain-core==1.2.6` ‚úÖ (patched version)
- **Latest available:** `langchain-core==1.2.6`

### Research Findings
‚ö†Ô∏è **Limited information available:**
- CVE-2025-68664 is not widely documented in public sources
- Web searches return information about CVE-2024-28088 (different vulnerability)
- May be very recent or use BDSA identifier primarily
- Version 1.2.3 is significantly newer than 0.3.80 and likely includes fixes

### Mitigation
‚úÖ **Likely mitigated** - Installed version (1.2.3) is much newer than vulnerable version (0.3.80)

**Action Required:**
- Verify with LangChain maintainers or security advisories if 1.2.3 includes CVE-2025-68664 fix
- Consider upgrading to latest (1.2.6) for additional security
- Update `requirements.lock` to reflect installed version
- Audit codebase to ensure we're not using vulnerable serialization functions

---

## Codebase Analysis

### LangGraph Checkpoint Usage
‚úÖ **Safe** - No SQLite checkpoint backend used:
- `planner_graph.py`: `workflow.compile()` (no checkpointer)
- `mcp_planner_graph.py`: `workflow.compile()` (no checkpointer)
- `mcp_integrated_planner_graph.py`: `workflow.compile()` (no checkpointer)

**Conclusion:** Using in-memory state management, not vulnerable SQLite checkpoint component.

### LangChain Serialization Usage
‚úÖ **Safe** - Using standard `json.dumps()`, not LangChain serialization:
- 116 instances of `json.dumps()` (standard library)
- 0 instances of `langchain.*.dumps()` or `langchain.*.dumpd()`

**Conclusion:** Not directly calling vulnerable LangChain serialization functions.

---

## Version Discrepancy Analysis

### Current State
| Package | requirements.txt | requirements.lock | Latest Available | Status |
|---------|------------------|-------------------|------------------|--------|
| `langgraph` | >=1.0.5 | 1.0.5 | 1.0.5 | ‚úÖ Synced |
| `langgraph-checkpoint` | (transitive) | 3.0.1 | 3.0.1 | ‚úÖ Synced |
| `langchain-core` | >=1.2.6 | 1.2.6 | 1.2.6 | ‚úÖ Synced |

### Impact
- **Positive:** Installed versions are newer and likely include security fixes
- **Risk:** `requirements.lock` doesn't reflect actual environment
- **Action:** Need to sync lock file with installed versions

---

## Recommended Actions

### Immediate (Priority: High)
1. ‚úÖ **Verify installed versions include fixes**
   - Confirm `langgraph-checkpoint==3.0.1` includes CVE-2025-8709 fix
   - Confirm `langchain-core==1.2.3` includes CVE-2025-68664 fix

2. ‚ö†Ô∏è **Update requirements.lock**
   - Sync with installed versions to maintain consistency
   - Update `requirements.txt` minimum versions if needed

3. üìù **Document defensive measures**
   - Add comments explaining in-memory state usage (avoids SQLite checkpoint)
   - Document that we use `json.dumps()`, not LangChain serialization

### Short-term (Priority: Medium)
4. üîç **Verify CVE-2025-68664 fix**
   - Contact LangChain maintainers or check GitHub security advisories
   - Verify if upgrade to 1.2.6 is needed

5. üß™ **Add security tests**
   - Test filter operations for SQL injection (if filters are used)
   - Test serialization with malicious `'lc'` keys

### Long-term (Priority: Low)
6. üìö **Update security documentation**
   - Add these vulnerabilities to `VULNERABILITY_MITIGATIONS.md`
   - Document version management process

7. üîÑ **Establish monitoring**
   - Set up Dependabot for security alerts
   - Regular dependency audits

---

## References

- [CVE-2025-8709 Details](https://www.wiz.io/vulnerability-database/cve/cve-2025-8709)
- [LangGraph PyPI](https://pypi.org/project/langgraph/)
- [LangChain Core PyPI](https://pypi.org/project/langchain-core/)
- [LangGraph Checkpoint PyPI](https://pypi.org/project/langgraph-checkpoint/)

---

## Next Steps

1. **Await approval** for recommended actions
2. **Verify** with maintainers if fixes are included in installed versions
3. **Update** requirements files to match installed versions
4. **Document** defensive measures in code

---

**Research Completed By:** AI Assistant  
**Date:** 2025-01-XX  
**Status:** Ready for Review

